<body>
    <p>
        <a href="/">
            <img alt="intervolga.ru" src="/assets/logo/logo.svg"/>
        </a>
    </p>
    <p>
        <a href="tel:+74956485790">
            +7 495 648 57 90
        </a>
    </p>
    <ul>
        <li>
            <p>
                <a href="/dev/">
                    Разработка на Битрикс
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/bitrix24/">
                    Битрикс24
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/1c/">
                    1С
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/adv/">
                    Интернет-маркетинг
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/vacancy/">
                    Вакансии
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/import/">
                    Импортозамещение
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/industries/">
                    Отрасли
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/web-integration/">
                    Кто мы
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/cases/">
                    Крупные проекты
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/portfolio/">
                    Портфолио
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/blog/">
                    Блог
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/contacts/">
                    Контакты
                </a>
            </p>
        </li>
    </ul>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/iblock/279/iaw42kmmn5qdx5i0f99yo5yujn9faka0.png.webp?w=1920"/>
    </p>
    <ol>
        <li>
            <a href="/" title="Главная">
                Главная
            </a>
        </li>
        <li>
            <ul>
                <li>
                </li>
            </ul>
        </li>
        <li>
            <a href="/blog/" title="Блог">
                Блог
            </a>
        </li>
        <li>
            <ul>
                <li>
                </li>
            </ul>
        </li>
        <li>
            <a href="/blog/projects/" title="Веб-Проекты">
                Веб-Проекты
            </a>
        </li>
        <li>
            <ul>
                <li>
                </li>
            </ul>
        </li>
        <li>
            <a href="/blog/projects/bitrix-for-programmmer-oop-orm-mvc-patterns/" title="Битрикс: пытаемся разобраться. Часть 2: Идеология и архитектура платформы 1с-Битрикс. ООП, ORM, Паттерны проектирования, MVC">
                Битрикс: пытаемся разобраться. Часть 2: Идеология и архитектура платформы 1с-Битрикс. ООП, ORM, Паттерны проектирования, MVC
            </a>
        </li>
    </ol>
    <h1>
        Битрикс: пытаемся разобраться. Часть 2: Идеология и архитектура платформы 1с-Битрикс. ООП, ORM, Паттерны проектирования, MVC
    </h1>
    <p>
        <a href="/people/stepan_ovchinnikov/">
            <img alt="" src="/upload/resize_cache/iblock/41f/60_60_2/41f4606acdc042641f72c06db3d401a6.png.webp"/>
            Степан Овчинников
        </a>
    </p>
    <p>
        <a href="/subscribe/">
            Подписаться
        </a>
    </p>
    <p>
        Это вторая из трех статей про техническую, архитектурную и бизнес-составляющую системы 1С-Битрикс.
    </p>
    <p>
        Статья ставит целью разобраться в колоссальном клубке вопросов, связанном с этой системой.
    </p>
    <p>
        Начало:
    </p>
    <p>
        <a href="/blog/bitrix/bitrix-platform/">
            Часть 1: Устройство и технические свойства платформы
        </a>
    </p>
    <p>
        Тут говорим об архитектуре.
    </p>
    <p>
        **Идеология и архитектура платформы
    </p>
    <ol>
        <li>
            Где ООП? Это структурный код, ООП и не пахнет.**
        </li>
    </ol>
    <p>
        Суть.
    </p>
    <p>
        ООП вообще стало чем-то вроде священной коровы, эдакой волшебной мантрой. Все что с большим количеством классов, интерфейсов и наследований - автоматически круто и профессионально, а если ты пишешь структурный код -- тебе стыд и порицание. А за goto в коде сразу сажают на кол.
    </p>
    <p>
        Знаете как в советских учениках было? Первобытный строй - Рабовладение - Феодализм - Капитализм - Социализм / Коммунизм. Типа линейное развитие. Чем дальше, тем круче. И все однозначно.
    </p>
    <p>
        Вот не так все. И в ПО не так.
    </p>
    <p>
        Попробуем порассуждать с позиции практичности. Что дает ООП и что — структурный код.
    </p>
    <p>
        Для каких задач нужен объектно-ориентированный подход?
    </p>
    <p>
        Он нужен для приложений со сложной бизнес-логикой, с перекрестными связями и зависимостями, с командной разработкой. Расписал интерфейсы, от общего развивающегося предка унаследовал и кайфуешь. Творишь. Все четко.
    </p>
    <p>
        В Битриксе ООП почти нет. Большой единой иерархии нет. Классы Битрикса это инструменты, служащие контейнером для логики и слабо связанные друг с другом.
    </p>
    <p>
        + (что в этом хорошего)
    </p>
    <p>
        1. Есть мнение что ООП как универсальная технология проектирования и кодирования почти любого софта не идеальна. В ней не так все просто и прямо как хочется. ООП -- не идеальная модель реального мира.
    </p>
    <p>
        2. ООП надо не везде. Есть мнение что ООП в вебе не надо. Слишком простые и мало развиваемые вещи делает рядовой разработчик. Он просто делает элемент, выводящий корзину заказа в дизайне сайта и с его особенностями в логике.
    </p>
    <p>
        И не надо для этого описывать ее поведение объектной моделью. Надо просто взять и кастомизировать код запроса на API и код вывода на html.
    </p>
    <p>
        3. Быстро учим. Не надо держать в голове иерархию. Не надо помнить тысячу штук и нюансов где что как сделано. Оно тут все. Просто и наглядно. И развиваемо в любую сторону.
    </p>
    <p>
        4. ООП мало кто хорошо понимает. Есть мнение что тысячи хороших программистов не могут писать на ООП. Им ближе, понятнее, прозрачнее скрипты и структурное кодирование.
    </p>
    <p>
        Цена ошибки в выборе базовой технологии очень высока. Дело в том, что если ООП-шник влезет в “структурный” проект, он все поймет и ничего не испортит. Если он совсем тупой, за счет слабой связности все легко вычистить.
    </p>
    <p>
        Если же “структурный” по стилю мышления человек влезет в суровое ООП дерево, он чего-нибудь там так унаследует и переопределит для вашего проекта, что мало не будет.
    </p>
    <p>
        Коротко говоря: больше задач малой кровью в ущерб академичности и стройности абстрактных структур.
    </p>
    <p>
        5. Никто не мешает прикрутить к Битриксу с его недо-ООП вашу собственную модель. И будет вам счастье, если оно для вас в ООП.
    </p>
    <p>
        -
    </p>
    <p>
        1. Многих раздражает. Операция копирования вместо наследования, классы как контейнеры, а не абстракции, та самая слабая связность.
    </p>
    <p>
        2. Копипаст. Если считать что хороший код тот, где нет копипаста и повторяющихся кусков логики, то в проектах на Битриксе (не в нем самом) код плохой.
    </p>
    <p>
        3. Если вы сделали свою версию компонента, которая очень мало отличается от исходного, и хотите обновиться, сохранившаяся часть логики не будет обновлена. Было бы это наследование, не переопределенная часть логики сохранилась бы и обновлялась бы.
    </p>
    <p>
        А так получается, что вы нажали зеленую кнопку в панели, все обновилось быстро, а ваши кастомизированные компоненты не получили новых фишек.
    </p>
    <p>
        <strong>
            2. MVC и паттерны проектирования.
        </strong>
    </p>
    <p>
        Суть
    </p>
    <p>
        Пресловутые паттерны, банда четырех, Мартин Фаулер и понты вокруг всего этого стали уже даже не символом профессионализма, а его протезом.
    </p>
    <p>
        Можно подумать что до появления идеи паттернов, изложенной в нескольких книгах вообще никто ничего серьезного не программировал. Кнут, Дейкстра, прочие умные товарищи -- судя по мнению современного гика -- гнилой отстой.
    </p>
    <p>
        Удивительно, как часто в студенческих или сразу-после-студенческих кругах всплывает эта тема: а в Битриксе есть паттерны? Как будто их наличие и четкое выделение в документации сразу делает его клевым софтом и снимает все вопросы.
    </p>
    <p>
        Товарищи программисты, давайте отставим юношеский максимализм и разберемся.
    </p>
    <p>
        Что такое паттерны? Это исчерпывающий список правильных действий?
    </p>
    <p>
        Лирическое отступление: у девочек в 17 лет есть справочник умных мыслей, позаимствованный частью у мамы, частью у лучшей подруги. Вот у современного “крутого девелопера” такой справочник сформировала банда четырех и Мартин Фаулер.
    </p>
    <p>
        Паттерн - это совет. Это эвристический прием типа “попробуй так, может получится хорошо”.
    </p>
    <p>
        Паттернов много, они описаны весьма абстрактно. Более того, есть версии и вариации на тему паттернов для отдельных языков программирования и технологий. В первоисточниках неоднократно разными словами высказана мысль что слепое применение паттернов или увлечение ими до наработки собственной профессиональной зрелости, приносит больше вреда чем пользы.
    </p>
    <p>
        Применение того или иного приема нужно выбирать по особенностям конкретной ситуации. Никто не сказал, что паттерн А лучше оригинального решения С.
    </p>
    <p>
        Это не скрижали Моисея, это неглупая, модная и в некоторых случаях полезная хрень, как, скажем, UML, Agile и RUP. Вам она помогает? Вы нашли в этом много полезного для своего уровня профессионального развития? Это прекрасно, но не надо быть наивными и считать что только так и можно писать.
    </p>
    <p>
        Итак. Паттерны -- не самоцель.
    </p>
    <p>
        Честно говоря, я бы вообще не обсуждал качество системы с точки зрения применения или не-применения конкретных паттернов, описанных в конкретных книгах.
    </p>
    <p>
        Но в Битриксе паттерны проектирования безусловно используются.
    </p>
    <p>
        +
    </p>
    <p>
        Разумеется, так как Битрикс пишут множество нормальных и профессиональных программистов, в нем много случаев применения так нужных фанатикам паттернов. Так же как таких случаев применения паттернов полно в любой умной большой программе.
    </p>
    <p>
        В Интернете есть ряд интереснейших дискуссий на эту тему между разработчиками, внедренцами и сторонними программистами. Прямых ссылок не будет, запрос “битрикс и паттерны проектирования” вас сразу приведет на эти страницы.
    </p>
    <p>
        Документация изобилует указаниями на то, какой паттерн применен в том или ином месте. В качестве примера можно привести страницы про Компоненты 2.0.
    </p>
    <p>
        -
    </p>
    <p>
        Нет собственной прописанной философии, идеологии, централизованного духа системы. Проще всего его было бы сформулировать как раз в виде своих или модифицированных базовых паттернов.
    </p>
    <p>
        Поскольку паттерны это религия, то каждый адепт считает себя носителем. И этот носитель утверждает в зависимости от опыта и степени адекватности что думает. А думают они совсем разное: кто-то практику применения ПП в Битриксе превозносит, кто-то поливает.
    </p>
    <p>
        Если бы было понятно всем, а не только редким специалистам, ПОЧЕМУ оно так сделано, было бы лучше.
    </p>
    <p>
        Вопрос паттернов дискуссионный, думаю в комментариях мое мнение будет дополнено.
    </p>
    <p>
        Отдельно стоит поговорить про важный паттерн проектирования MVC.
    </p>
    <p>
        <strong>
            MVC
        </strong>
    </p>
    <p>
        +
    </p>
    <p>
        Есть мнение (оно совпадает с официальным) что MVC в Битриксе есть. Посмотрите описание Компонентов 2.0.
    </p>
    <p>
        Есть модель -- модули (я встречал версии, что это инфоблоки, админка, ядро), контроллер (компоненты, возможно файлы страниц сайта, urlrewrite), вид (шаблон или компонент целиком).
    </p>
    <p>
        Если оно устраивает потребителя (программиста и его работодателя), то применение ПП надо считать адекватным.
    </p>
    <p>
        -
    </p>
    <p>
        Есть также мнение, что MVC в Битриксе нет.
    </p>
    <p>
        Доводы в пользу этой мысли.
    </p>
    <p>
        Модель размыта.
    </p>
    <p>
        Контроллеров много.
    </p>
    <p>
        View (если понимать его широко) находится в шаблоне и в самом компоненте и не так уж отделен от контроллера.
    </p>
    <p>
        Не исключено, что этой мысли придерживаются люди, которые знакомы с конкретной реализацией MVC, например в Zend Framework.
    </p>
    <p>
        <strong>
            3. Где ORM?
        </strong>
    </p>
    <p>
        Суть
    </p>
    <p>
        ORM – красивая и интересная технология, при которой программист оперирует объектами своей модели, переходит по связям и выполняет действия на высоком уровне абстракции, а движок ORM переводит все это в язык запросов и отражает происходящее в хранилище данных.
    </p>
    <p>
        Получается такой постоянный перевод, меппинг состояния памяти в БД и доступ к данным со всеми прелестями объектной модели.
    </p>
    <p>
        Собственно, ORM это и есть object-relational mapping.
    </p>
    <p>
        В php-версии Битрикса ORM нет.
    </p>
    <p>
        Достоинством ORM является красота, краткость кода, все виды контроля, доступность объектов в памяти.
    </p>
    <p>
        Недостатком ORM в ее классическом понимании являются повышенные требования к производительности и памяти. Это так или иначе решается ленивой загрузкой, ленивой генерацией instance’ов, внутренним кешированием, но тем не менее проблема налицо.
    </p>
    <p>
        Ну и естественно, нужна нормальная объектная модель.
    </p>
    <p>
        + (что хорошего в том, что в Битриксе нет ORM)
    </p>
    <p>
        Пример. Нужно получить список заказов человека.
    </p>
    <p>
        С ORM имеем код типа theMan->Orders(), и список заказов в объектах.
    </p>
    <p>
        В Битриксе вам не удастся получить список заказов в объектах, только в ассоциативном массиве, и не за один запрос. Сначала список ID, потом сами заказы.
    </p>
    <p>
        theMan->Orders() генерирует массу объектов со всеми полями. Требуется много процессора и много памяти.
    </p>
    <p>
        Стиль Битрикса позволяет получать ровно те данные, которые вам нужны.
    </p>
    <p>
        Ну и разумеется, поскольку в Битриксе вообще мало что сделано объектами, а пользовательские сущности (отдельные новости, например) вообще объектами не являются, довольно странно говорить об их меппинге.
    </p>
    <p>
        Если ваша задача требует ORM, ничего не мешает прикрутить к системе любую, работающую на php+mysql, например Doctrine.
    </p>
    <p>
        Есть мнение, что применение ORM в сайтостроении (довольно простых проектах с точки зрения большого программирования) вообще неоправданно.
    </p>
    <p>
        - (что плохого в отсутствии ORM)
    </p>
    <p>
        Была бы ORM, которая бы умела экономить память, процессор и другие ресурсы, получала бы данные дозировано (сама) и в то же время позволяла красиво писать и быстро осваивалась – было бы отлично.
    </p>
    <p>
        Такого нет в Битриксе.
    </p>
    <p>
        Выводы по второй части.
    </p>
    <p>
        ООП, ORM, Паттерны, MVC и прочие архитектурные вопросы сложны и рядовому пользователю и разработчику сложно о них судить.
    </p>
    <p>
        Я не специалист в этом (не взялся бы проектировать CMS). Я постарался разобраться сам и аккумулировать в статье те доводы, которые нашел, понял и готов аргументировать.
    </p>
    <p>
        Хорошо, что никому из нас, пользователей или партнеров системы, не приходится решать архитектурные вопросы. Пусть о них болит голова у тех, кто за это отвечает.
    </p>
    <p>
        Лично я не вижу никаких существенных недостатков для нас как для разработчиков и партнеров от такой архитектуры. Она работает.
    </p>
    <p>
        <a href="/blog/projects/bitrix-for-sysadmin-director-developer/">
            Часть 3: Битрикс для бизнеса. Взгляд сисадмина, разработчика, директора
        </a>
    </p>
    <p>
        Буду благодарен за дополнения.
    </p>
    <p>
        Оцените статью
    </p>
    <p>
        Empty
    </p>
    <p>
        08.07.2012
    </p>
    <p>
        Понравилась статья?
    </p>
    <p>
        Поделитесь ссылкой с друзьями и коллегами!
    </p>
    <h3>
        Статьи по теме
    </h3>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/72c/470_200_2/tuyd87zdorzwitrgbiy23e0tjwvelto6.jpg.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/sistema-loyalnosti-v-b2b-prodazhakh-kak-sozdat-i-budut-li-rezultaty/">
            Система лояльности в B2B-продажах: как создать и будут ли результаты
        </a>
        В B2B-продажах клиенты ищут не просто продукт, а партнера, который поможет им решить их бизнес-проблемы. Привлечение и удержание клиентов — одна из ...
    </p>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/43e/470_200_2/uxp2ez5pt78085puvl640v09dvz35svc.jpg.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/sozdaem-kontent-khab-na-pimcore/">
            Создаем контент-хаб товарных данных на Pimcore
        </a>
        Наступит день, когда ваши 1С или БД сайта перестанут справляться с возросшим объемом товарного медиаконтента. Рассказываем как организовать правильное хранение ...
    </p>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/4ac/470_200_2/v5x8l0zfvbhlx4voieruipfu7r9w35bj.jpg.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/vyzhimaem-maksimum-skorosti-iz-php/">
            Выжимаем максимум скорости из PHP
        </a>
        Когда дело доходит до запуска PHP-приложений, выбор подходящего веб-сервера критически важен. Цель статьи — помочь в выборе оптимального решения для своих проек...
    </p>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/a25/470_200_2/xgq29ifcvq6w7lq5imutud99rsgffjx9.png.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/organizatsiya-poiska-na-sayte-vybiraem-mezhdu-poiskom-bitriksa-sphinx-i-elasticsearch/">
            Организация поиска на сайте: выбираем между поиском Битрикса, Sphinx и Elasticsearch
        </a>
        В статье разбираем популярные поисковые движки, чтобы выбрать лучший под задачи конкретного проекта. Даем советы по индексации каталога и построении «умного» фи...
    </p>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/425/470_200_2/yz9mn3dr07ihnc5uhatfgvjn911yq80c.jpg.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/dorabotka-sistemy-lms-knomary/">
            Доработка системы LMS Knomary
        </a>
        Must have для бизнеса, где главный актив это люди, — стратегия обучения и развития персонала. Рассказываем как помогли доработать LMS-систему для компании ЕВРАЗ...
    </p>
    <p>
        <img alt="" src="https://www.intervolga.ru/upload/resize_cache/iblock/fb0/470_200_2/fci6sf0g1flr0qjsxk9ao4x1232kuihb.png.webp?w=1920"/>
    </p>
    <p>
        <a href="/blog/projects/kak-ranshe-bolshe-ne-rabotaet-b2b-sistema-prodazh-seychas/">
            «Как раньше» больше не работает — B2B-система продаж сейчас
        </a>
        В этой статье хотим поговорить с чем сейчас сталкивается оптовый бизнес (множеством вызовов и изменений, которые требуют адаптации, а также оптимизации процессо...
    </p>
    <p>
        Мы работаем по одному из двух форматов:
    </p>
    <ul>
        <li>
            аренда команды (от 2 человек, не менее 3 месяцев);
        </li>
        <li>
            итерации с фиксированной ценой (1-3 месяца длительностью).
        </li>
    </ul>
    <p>
        ИНТЕРВОЛГА предоставляет:
    </p>
    <ul>
        <li>
            регулярные онлайн-планерки с заказчиком;
        </li>
        <li>
            квалифицированных специалистов;
        </li>
        <li>
            организованную команду (находятся в одном помещении, что упрощает решение рабочих вопросов);
        </li>
        <li>
            полную прозрачность и регулярность отчетов о результатах.
        </li>
    </ul>
    <p>
        Ключевые услуги:
    </p>
    <ul>
        <li>
            нагруженный интернет-магазин;
        </li>
        <li>
            личный кабинет;
        </li>
        <li>
            оптовые продажи — B2B-платформа;
        </li>
        <li>
            маркетплейс;
        </li>
        <li>
            технический аудит сайта;
        </li>
        <li>
            Битрикс24 — корпоративные HR-порталы;
        </li>
        <li>
            Битрикс24 — построение CRM-системы;
        </li>
        <li>
            Битрикс24 — личные кабинеты сотрудников;
        </li>
        <li>
            Битрикс24 — аудит портала;
        </li>
        <li>
            1С — интеграция с другими системами;
        </li>
        <li>
            1С — доработка системы;
        </li>
        <li>
            маркетинг — комплексное интернет-продвижение;
        </li>
        <li>
            маркетинг — продвижение для B2B.
        </li>
    </ul>
    <p>
        Хотите получать лучшие статьи от INTERVOLGA раз в месяц?
    </p>
    <p>
        Подпишитесь на рассылку — спамить не будем
    </p>
    <p>
        <a href="/">
            <img alt="intervolga.ru" src="/assets/logo/white.svg"/>
        </a>
    </p>
    <ul>
        <li>
            <p>
                <a href="/">
                    Москва
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/volgograd/">
                    Волгоград
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/drugoe/rostov/">
                    Ростов
                </a>
            </p>
        </li>
        <li>
            <p>
                <a href="/contacts/">
                    Контакты
                </a>
            </p>
        </li>
        <li>
            <p>
                [+7 495 648 57 90](tel:+7 495 648 57 90)
            </p>
        </li>
        <li>
            <p>
                [+7 844 295 99 99](tel:+7 844 295 99 99)
            </p>
        </li>
        <li>
            <p>
                <a href="mailto:info@intervolga.ru">
                    info@intervolga.ru
                </a>
            </p>
        </li>
    </ul>
    <p>
        © 2003-2025, интернет-агентство INTERVOLGA
    </p>
    <p>
        <a href="/privacy/">
            Политика конфиденциальности
        </a>
    </p>
</body>